
[2020-10-23 14:27:00]
Traceback (most recent call last):
  File "/Users/wangken/py/pcba_allocation/wsgi.py", line 109, in allocation_run
    output_filename=pcba_allocation_main_program(df_3a4, df_oh, df_transit, df_scr, pcba_site, bu_list, ranking_col)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 860, in pcba_allocation_main_program
    ss_priority=read_backlog_priority_from_smartsheet(smartsheet_client, sheet_id)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 22, in read_backlog_priority_from_smartsheet
    df_smart.Ranking=df_smart.Ranking.astype(int)
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/generic.py", line 5546, in astype
    new_data = self._mgr.astype(dtype=dtype, copy=copy, errors=errors,)
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/internals/managers.py", line 595, in astype
    return self.apply("astype", dtype=dtype, copy=copy, errors=errors)
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/internals/managers.py", line 406, in apply
    applied = getattr(b, f)(**kwargs)
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/internals/blocks.py", line 595, in astype
    values = astype_nansafe(vals1d, dtype, copy=True)
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/dtypes/cast.py", line 972, in astype_nansafe
    return lib.astype_intsafe(arr.ravel(), dtype).reshape(arr.shape)
  File "pandas/_libs/lib.pyx", line 614, in pandas._libs.lib.astype_intsafe
ValueError: invalid literal for int() with base 10: '1.6'

[2020-10-23 14:31:43]
Traceback (most recent call last):
  File "/Users/wangken/py/pcba_allocation/wsgi.py", line 109, in allocation_run
    output_filename=pcba_allocation_main_program(df_3a4, df_oh, df_transit, df_scr, pcba_site, bu_list, ranking_col)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 860, in pcba_allocation_main_program
    ss_priority=read_backlog_priority_from_smartsheet(smartsheet_client, sheet_id)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 22, in read_backlog_priority_from_smartsheet
    df_smart.Ranking=df_smart.Ranking.astype(float)
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/generic.py", line 5546, in astype
    new_data = self._mgr.astype(dtype=dtype, copy=copy, errors=errors,)
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/internals/managers.py", line 595, in astype
    return self.apply("astype", dtype=dtype, copy=copy, errors=errors)
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/internals/managers.py", line 406, in apply
    applied = getattr(b, f)(**kwargs)
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/internals/blocks.py", line 595, in astype
    values = astype_nansafe(vals1d, dtype, copy=True)
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/dtypes/cast.py", line 995, in astype_nansafe
    return arr.astype(dtype, copy=True)
ValueError: could not convert string to float: 'a'

[2020-10-23 14:41:44]
Traceback (most recent call last):
  File "/Users/wangken/py/pcba_allocation/wsgi.py", line 109, in allocation_run
    output_filename=pcba_allocation_main_program(df_3a4, df_oh, df_transit, df_scr, pcba_site, bu_list, ranking_col)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 926, in pcba_allocation_main_program
    output_filename = write_excel_output_file(bu_list, df_scr, df_3a4, df_transit)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 680, in write_excel_output_file
    df_3a4 = df_3a4[df_3a4.BOM_PN.notnull()][output_col_3a4].copy()
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/frame.py", line 2908, in __getitem__
    indexer = self.loc._get_listlike_indexer(key, axis=1, raise_missing=True)[1]
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/indexing.py", line 1254, in _get_listlike_indexer
    self._validate_read_indexer(keyarr, indexer, axis, raise_missing=raise_missing)
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/indexing.py", line 1304, in _validate_read_indexer
    raise KeyError(f"{not_found} not in index")
KeyError: "['priority_ranking_temp'] not in index"

[2020-10-23 14:51:21]
Traceback (most recent call last):
  File "/Users/wangken/py/pcba_allocation/wsgi.py", line 109, in allocation_run
    output_filename=pcba_allocation_main_program(df_3a4, df_oh, df_transit, df_scr, pcba_site, bu_list, ranking_col)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 869, in pcba_allocation_main_program
    df_3a4 = ss_ranking_overall_new(df_3a4, ss_priority, ranking_col, order_col='SO_SS', new_col='ss_overall_rank')
  File "/Users/wangken/py/pcba_allocation/functions.py", line 636, in ss_ranking_overall_new
    ss_priority[df_3a4.SO_SS],
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/generic.py", line 1669, in __hash__
    f"{repr(type(self).__name__)} objects are mutable, "
TypeError: 'Series' objects are mutable, thus they cannot be hashed

[2020-10-23 14:55:56]
Traceback (most recent call last):
  File "/Users/wangken/py/pcba_allocation/wsgi.py", line 109, in allocation_run
    output_filename=pcba_allocation_main_program(df_3a4, df_oh, df_transit, df_scr, pcba_site, bu_list, ranking_col)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 930, in pcba_allocation_main_program
    output_filename = write_excel_output_file(bu_list, df_scr, df_3a4, df_transit)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 684, in write_excel_output_file
    df_3a4 = df_3a4[df_3a4.BOM_PN.notnull()][output_col_3a4].copy()
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/frame.py", line 2908, in __getitem__
    indexer = self.loc._get_listlike_indexer(key, axis=1, raise_missing=True)[1]
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/indexing.py", line 1254, in _get_listlike_indexer
    self._validate_read_indexer(keyarr, indexer, axis, raise_missing=raise_missing)
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/indexing.py", line 1304, in _validate_read_indexer
    raise KeyError(f"{not_found} not in index")
KeyError: "['priority_rank_temp'] not in index"

[2020-10-27 10:58:35]
Traceback (most recent call last):
  File "/Users/wangken/py/pcba_allocation/wsgi.py", line 109, in allocation_run
    output_filename=pcba_allocation_main_program(df_3a4, df_oh, df_transit, df_scr, pcba_site, bu_list, ranking_col)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 914, in pcba_allocation_main_program
    ss_priority=read_backlog_priority_from_smartsheet()
  File "/Users/wangken/py/pcba_allocation/functions.py", line 20, in read_backlog_priority_from_smartsheet
    smartsheet_client = SmartSheetClient(token, proxies)
  File "/Users/wangken/py/pcba_allocation/smartsheet_handler.py", line 12, in __init__
    self.smartsheet_client = smartsheet.Smartsheet(access_token=access_token, proxies=proxies)
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/smartsheet/smartsheet.py", line 145, in __init__
    raise ValueError('Access Token must be set in the environment '
ValueError: Access Token must be set in the environment or passed to smartsheet.Smartsheet() as a parameter.

[2020-10-28 11:51:58]
Traceback (most recent call last):
  File "/Users/wangken/py/pcba_allocation/wsgi.py", line 103, in allocation_run
    output_filename=pcba_allocation_main_program(df_3a4, df_oh, df_transit, df_scr, pcba_site, bu_list, ranking_col)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 973, in pcba_allocation_main_program
    df_scr = process_final_allocated_output(df_scr, tan_bu, df_3a4, df_oh, df_transit, pcba_site)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 497, in process_final_allocated_output
    df_scr['oh+transit'] - df_scr.Backlog,
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/generic.py", line 5139, in __getattr__
    return object.__getattribute__(self, name)
AttributeError: 'DataFrame' object has no attribute 'Backlog'

[2020-10-28 11:58:19]
Traceback (most recent call last):
  File "/Users/wangken/py/pcba_allocation/wsgi.py", line 103, in allocation_run
    output_filename=pcba_allocation_main_program(df_3a4, df_oh, df_transit, df_scr, pcba_site, bu_list, ranking_col)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 973, in pcba_allocation_main_program
    df_scr = process_final_allocated_output(df_scr, tan_bu, df_3a4, df_oh, df_transit, pcba_site)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 497, in process_final_allocated_output
    df_scr['oh+transit'] - df_scr.Unpacked_blg,
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/generic.py", line 5139, in __getattr__
    return object.__getattribute__(self, name)
AttributeError: 'DataFrame' object has no attribute 'Unpacked_blg'

[2020-10-29 09:07:47]
Traceback (most recent call last):
  File "/Users/wangken/py/pcba_allocation/wsgi.py", line 103, in allocation_run
    output_filename=pcba_allocation_main_program(df_3a4, df_oh, df_transit, df_scr, pcba_site, bu_list, ranking_col)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 912, in pcba_allocation_main_program
    ss_priority=read_backlog_priority_from_smartsheet()
  File "/Users/wangken/py/pcba_allocation/functions.py", line 20, in read_backlog_priority_from_smartsheet
    smartsheet_client = SmartSheetClient(token, proxies)
  File "/Users/wangken/py/pcba_allocation/smartsheet_handler.py", line 12, in __init__
    self.smartsheet_client = smartsheet.Smartsheet(access_token=access_token, proxies=proxies)
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/smartsheet/smartsheet.py", line 145, in __init__
    raise ValueError('Access Token must be set in the environment '
ValueError: Access Token must be set in the environment or passed to smartsheet.Smartsheet() as a parameter.

[2020-11-02 14:08:47]
Traceback (most recent call last):
  File "/Users/wangken/py/pcba_allocation/wsgi.py", line 101, in allocation_run
    output_filename=pcba_allocation_main_program(df_3a4, df_oh, df_transit, df_scr, pcba_site, bu_list, ranking_col)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 912, in pcba_allocation_main_program
    ss_priority=read_backlog_priority_from_smartsheet()
  File "/Users/wangken/py/pcba_allocation/functions.py", line 20, in read_backlog_priority_from_smartsheet
    smartsheet_client = SmartSheetClient(token, proxies)
  File "/Users/wangken/py/pcba_allocation/smartsheet_handler.py", line 12, in __init__
    self.smartsheet_client = smartsheet.Smartsheet(access_token=access_token, proxies=proxies)
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/smartsheet/smartsheet.py", line 145, in __init__
    raise ValueError('Access Token must be set in the environment '
ValueError: Access Token must be set in the environment or passed to smartsheet.Smartsheet() as a parameter.

User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36
2020-11-02 14:26:36
PCBA_SITE: FOL
BU: ERBU
BU: ERBU
File 3a4: 3a4 (2).csv
File supply: supply (3).xlsx
Finish time: 2020-11-02 14:27:13[2020-11-02 14:32:47]

User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36
Start time: 14:32:47
PCBA_SITE: FOL
BU: ERBU/SRGBU
File 3a4: 3a4 (2).csv
File supply: supply (4).xlsx
Finish time: 14:33:34[2020-11-02 14:35:46]

User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36
Start time: 14:35:46
PCBA_SITE: FOL
BU: ERBU/SRGBU
File 3a4: 3a4 (2).csv
File supply: supply (4).xlsx
Finish time: 14:36:34
[2020-11-02 14:37:57]
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36
Start time: 14:37:57
PCBA_SITE: FOL
BU: ERBU/SRGBU
File 3a4: 3a4 (2).csv
File supply: supply (4).xlsx
Finish time: 14:38:44

[2020-11-02]
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36
Start time: 14:40:18
PCBA_SITE: FOL
BU: ERBU/SRGBU
File 3a4: 3a4 (2).csv
File supply: supply (4).xlsx
Finish time: 14:41:07

[2020-11-02] - making allocation
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36
Start time: 14:46:49
PCBA_SITE: FOL
BU: ERBU
File 3a4: 3a4 (2).csv(size: 89270876)
File supply: supply (3).xlsx(size: 1536987)
Finish time: 14:47:25

[2020-11-02] - making allocation
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36
Start time: 14:53:42
PCBA_SITE: FOL
BU: ERBU
File 3a4: 3a4 (2).csv(size: 85.1Mb)
File supply: supply (3).xlsx(size: 1.5Mb)
Finish time: 14:54:20

[2020-11-02] - download file
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36
File name: FOL SCR allocation (all BU) 10-23 22h37m.xlsx

[2020-11-02] - download file
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36
File name: 3a4.csv-delete

[Making allocation] - 2020-11-09
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.183 Safari/537.36
Start time: 10:49:46
PCBA_SITE: FOL
BU: 
File 3a4: backlog3a4-detail2.csv(size: 90.6Mb)
File supply: Copy_of_test_SCROHIntransit_1104.xlsx(size: 1.2Mb)
ERROR!!!!10:50:41Traceback (most recent call last):
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/indexes/base.py", line 2895, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 70, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 101, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 1675, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 1683, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'planningOrg'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/wangken/py/pcba_allocation/wsgi.py", line 116, in allocation_run
    output_filename=pcba_allocation_main_program(df_3a4, df_oh, df_transit, df_scr, pcba_site, bu_list, ranking_col)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 1012, in pcba_allocation_main_program
    df_oh=add_up_supply_by_pn(df_oh,org_col='planningOrg',pn_col='TAN')
  File "/Users/wangken/py/pcba_allocation/functions.py", line 125, in add_up_supply_by_pn
    df.loc[:, 'org_pn'] = df[org_col] + '_' + df[pn_col]
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/frame.py", line 2902, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/indexes/base.py", line 2897, in get_loc
    raise KeyError(key) from err
KeyError: 'planningOrg'


[Making allocation] - 2020-11-09
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.183 Safari/537.36
Start time: 10:53:45
PCBA_SITE: FOL
BU: 
File 3a4: backlog3a4-detail2.csv(size: 90.6Mb)
File supply: Copy_of_test_SCROHIntransit_1104.xlsx(size: 1.2Mb)
Finish time: 10:55:35

[Making allocation] - 2020-11-09
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.183 Safari/537.36
Start time: 11:16:36
PCBA_SITE: FOL
BU: 
File 3a4: backlog3a4-detail2.csv(size: 90.6Mb)
File supply: Copy_of_test_SCROHIntransit_1104.xlsx(size: 1.2Mb)
ERROR!!!!11:17:42Traceback (most recent call last):
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/indexes/base.py", line 2895, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 70, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 101, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 1675, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 1683, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TAN'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/wangken/py/pcba_allocation/wsgi.py", line 116, in allocation_run
    output_filename=pcba_allocation_main_program(df_3a4, df_oh, df_transit, df_scr, pcba_site, bu_list, ranking_col)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 1047, in pcba_allocation_main_program
    df_oh=change_pn_to_group_number(df_oh,tan_group,pn_col='TAN')
  File "/Users/wangken/py/pcba_allocation/functions.py", line 127, in change_pn_to_group_number
    df.loc[:,pn_col]=df[pn_col].map(lambda x: tan_group[x] if x in tan_group.keys() else x)
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/frame.py", line 2902, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/indexes/base.py", line 2897, in get_loc
    raise KeyError(key) from err
KeyError: 'TAN'


[Making allocation] - 2020-11-09
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.183 Safari/537.36
Start time: 11:19:49
PCBA_SITE: FOL
BU: 
File 3a4: backlog3a4-detail2.csv(size: 90.6Mb)
File supply: Copy_of_test_SCROHIntransit_1104.xlsx(size: 1.2Mb)
ERROR!!!!11:21:03Traceback (most recent call last):
  File "/Users/wangken/py/pcba_allocation/wsgi.py", line 116, in allocation_run
    output_filename=pcba_allocation_main_program(df_3a4, df_oh, df_transit, df_scr, pcba_site, bu_list, ranking_col)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 1081, in pcba_allocation_main_program
    df_scr = process_final_allocated_output(df_scr, tan_bu, df_3a4, df_oh, df_transit, pcba_site)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 560, in process_final_allocated_output
    df_scr.loc[:, 'BU'] = df_scr.TAN.map(lambda x: tan_bu[x])
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/series.py", line 3970, in map
    new_values = super()._map_values(arg, na_action=na_action)
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/base.py", line 1160, in _map_values
    new_values = map_f(values, mapper)
  File "pandas/_libs/lib.pyx", line 2402, in pandas._libs.lib.map_infer
  File "/Users/wangken/py/pcba_allocation/functions.py", line 560, in <lambda>
    df_scr.loc[:, 'BU'] = df_scr.TAN.map(lambda x: tan_bu[x])
KeyError: 'WNBU_group_1'


[Making allocation] - 2020-11-09
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.183 Safari/537.36
Start time: 11:29:47
PCBA_SITE: FOL
BU: 
File 3a4: backlog3a4-detail2.csv(size: 90.6Mb)
File supply: Copy_of_test_SCROHIntransit_1104.xlsx(size: 1.2Mb)
ERROR!!!!11:30:07Traceback (most recent call last):
  File "/Users/wangken/py/pcba_allocation/wsgi.py", line 116, in allocation_run
    output_filename=pcba_allocation_main_program(df_3a4, df_oh, df_transit, df_scr, pcba_site, bu_list, ranking_col)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 1011, in pcba_allocation_main_program
    tan_bu,df_scr = extract_bu_from_scr(df_scr)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 561, in extract_bu_from_scr
    tan_bu[tan] = row.BU
AttributeError: 'Pandas' object has no attribute 'BU'


[Making allocation] - 2020-11-09
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.183 Safari/537.36
Start time: 11:40:39
PCBA_SITE: FOL
BU: 
File 3a4: backlog3a4-detail2.csv(size: 90.6Mb)
File supply: Copy_of_test_SCROHIntransit_1104.xlsx(size: 1.2Mb)
ERROR!!!!11:40:52Traceback (most recent call last):
  File "/Users/wangken/py/pcba_allocation/wsgi.py", line 116, in allocation_run
    output_filename=pcba_allocation_main_program(df_3a4, df_oh, df_transit, df_scr, pcba_site, bu_list, ranking_col)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 978, in pcba_allocation_main_program
    tan_bu = extract_bu_from_scr(df_scr)
TypeError: extract_bu_from_scr() missing 1 required positional argument: 'tan_group'


[Making allocation] - 2020-11-09
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.183 Safari/537.36
Start time: 11:45:34
PCBA_SITE: FOL
BU: 
File 3a4: backlog3a4-detail2.csv(size: 90.6Mb)
File supply: Copy_of_test_SCROHIntransit_1104.xlsx(size: 1.2Mb)
Finish time: 11:47:11

[Making allocation] - 2020-11-09
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.183 Safari/537.36
Start time: 13:35:08
PCBA_SITE: FOL
BU: 
File 3a4: backlog3a4-detail2.csv(size: 90.6Mb)
File supply: Copy_of_test_SCROHIntransit_1104.xlsx(size: 1.2Mb)
Finish time: 13:37:13

[Making allocation] - 2020-11-09
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.183 Safari/537.36
Start time: 20:06:58
PCBA_SITE: FOL
BU: 
File 3a4: backlog3a4-detail3.csv(size: 86.1Mb)
File supply: test_SCROHIntransit_1109.xlsx(size: 1.4Mb)
Finish time: 20:08:59

[Download/delete file] - 2020-11-10 10:27:37
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.183 Safari/537.36
File name: 

[Download/delete file] - 2020-11-10 10:28:37
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.183 Safari/537.36
File name: 

[Download/delete file] - 2020-11-10 11:51:21
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.183 Safari/537.36
Download supply from DB

[Download/delete file] - 2020-11-10 12:05:12
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.183 Safari/537.36
Download supply from DB

[Download/delete file] - 2020-11-10 13:39:01
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.183 Safari/537.36
Download supply from DB

[Download/delete file] - 2020-11-10 13:43:18
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.183 Safari/537.36
Download supply from DB

[Download/delete file] - 2020-11-10 14:05:25
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.183 Safari/537.36
Download supply from DB

[Download/delete file] - 2020-11-10 15:13:30
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.183 Safari/537.36
Download supply from DB

[Download/delete file] - 2020-11-10 15:14:22
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.183 Safari/537.36
Download supply from DB

[Making allocation] - 2020-11-17
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.193 Safari/537.36
Start time: 08:41:41
PCBA_SITE: FOL
BU: 
File 3a4: backlog3a4-detail (33).csv(size: 83.6Mb)
File supply: SCR_OH_Intransit 11-10 1514.xlsx(size: 1.6Mb)
ERROR!!!!08:42:01Traceback (most recent call last):
  File "/Users/wangken/py/pcba_allocation/wsgi.py", line 117, in allocation_run
    output_filename=pcba_allocation_main_program(df_3a4, df_oh, df_transit, df_scr, pcba_site, bu_list, ranking_col)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 982, in pcba_allocation_main_program
    tan_group = read_tan_group_mapping_from_smartsheet()
  File "/Users/wangken/py/pcba_allocation/functions.py", line 42, in read_tan_group_mapping_from_smartsheet
    smartsheet_client = SmartSheetClient(token, proxies)
  File "/Users/wangken/py/pcba_allocation/smartsheet_handler.py", line 12, in __init__
    self.smartsheet_client = smartsheet.Smartsheet(access_token=access_token, proxies=proxies)
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/smartsheet/smartsheet.py", line 145, in __init__
    raise ValueError('Access Token must be set in the environment '
ValueError: Access Token must be set in the environment or passed to smartsheet.Smartsheet() as a parameter.


[Making allocation] - 2020-11-17
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.193 Safari/537.36
Start time: 08:43:38
PCBA_SITE: FOL
BU: 
File 3a4: backlog3a4-detail (33).csv(size: 83.6Mb)
File supply: SCR_OH_Intransit 11-10 1514.xlsx(size: 1.6Mb)
Finish time: 08:45:59

[Making allocation] - 2020-11-17
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.193 Safari/537.36
Start time: 10:24:22
PCBA_SITE: FOL
BU: ERBU
File 3a4: backlog3a4-detail (33).csv(size: 83.6Mb)
File supply: SCR_OH_Intransit 11-10 1514.xlsx(size: 1.6Mb)
ERROR!!!!10:25:07Traceback (most recent call last):
  File "/Users/wangken/py/pcba_allocation/wsgi.py", line 117, in allocation_run
    output_filename=pcba_allocation_main_program(df_3a4, df_oh, df_transit, df_scr, pcba_site, bu_list, ranking_col)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 1120, in pcba_allocation_main_program
    df_scr = process_final_allocated_output(df_scr, tan_bu, df_3a4, df_oh, df_transit, pcba_site)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 636, in process_final_allocated_output
    backlog_target_ssd=calculate_x_days_target_ssd_backlog(df_3a4, days=7)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 991, in calculate_x_days_target_ssd_backlog
    dfx=df_3a4[(df_3a4.TARGET_SSD<=days_cutoff)&(df_3a4.PACKOUT_QUANTITY!='Packout Completed')]
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/ops/common.py", line 65, in new_method
    return method(self, other)
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/ops/__init__.py", line 370, in wrapper
    res_values = comparison_op(lvalues, rvalues, op)
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/ops/array_ops.py", line 244, in comparison_op
    res_values = comp_method_OBJECT_ARRAY(op, lvalues, rvalues)
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/ops/array_ops.py", line 56, in comp_method_OBJECT_ARRAY
    result = libops.scalar_compare(x.ravel(), y, op)
  File "pandas/_libs/ops.pyx", line 103, in pandas._libs.ops.scalar_compare
TypeError: '<=' not supported between instances of 'str' and 'Timestamp'


[Making allocation] - 2020-11-17
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.193 Safari/537.36
Start time: 10:40:37
PCBA_SITE: FOL
BU: ERBU
File 3a4: backlog3a4-detail (33).csv(size: 83.6Mb)
File supply: SCR_OH_Intransit 11-10 1514.xlsx(size: 1.6Mb)
Finish time: 10:41:31

[Making allocation] - 2020-11-17
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.193 Safari/537.36
Start time: 14:56:20
PCBA_SITE: FOL
BU: ERBU
File 3a4: backlog3a4-detail (33).csv(size: 83.6Mb)
File supply: SCR_OH_Intransit 11-10 1514.xlsx(size: 1.6Mb)
ERROR!!!!14:57:09Traceback (most recent call last):
  File "/Users/wangken/py/pcba_allocation/wsgi.py", line 117, in allocation_run
    output_filename=pcba_allocation_main_program(df_3a4, df_oh, df_transit, df_scr, pcba_site, bu_list, ranking_col)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 1179, in pcba_allocation_main_program
    df_scr = process_final_allocated_output(df_scr, tan_bu, df_3a4, df_oh, df_transit, pcba_site)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 1007, in process_final_allocated_output
    tan_allocation_wk=calculate_x_weeks_allocation(df_scr, pcba_site, wk='wk0')
  File "/Users/wangken/py/pcba_allocation/functions.py", line 933, in calculate_x_weeks_allocation
    dfx=df_scr[df_scr.ORG!=pcba_site]
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/generic.py", line 5139, in __getattr__
    return object.__getattribute__(self, name)
AttributeError: 'DataFrame' object has no attribute 'ORG'


[Making allocation] - 2020-11-17
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.193 Safari/537.36
Start time: 15:04:56
PCBA_SITE: FOL
BU: ERBU
File 3a4: backlog3a4-detail (33).csv(size: 83.6Mb)
File supply: SCR_OH_Intransit 11-10 1514.xlsx(size: 1.6Mb)
ERROR!!!!15:05:51Traceback (most recent call last):
  File "/Users/wangken/py/pcba_allocation/wsgi.py", line 117, in allocation_run
    output_filename=pcba_allocation_main_program(df_3a4, df_oh, df_transit, df_scr, pcba_site, bu_list, ranking_col)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 1178, in pcba_allocation_main_program
    df_scr = process_final_allocated_output(df_scr, tan_bu, df_3a4, df_oh, df_transit, pcba_site)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 998, in process_final_allocated_output
    tan_allocation_wk=calculate_x_weeks_allocation(df_scr, pcba_site, wk='wk0')
  File "/Users/wangken/py/pcba_allocation/functions.py", line 938, in calculate_x_weeks_allocation
    if date>supply_cut_off:
TypeError: '>' not supported between instances of 'str' and 'datetime.date'


[Making allocation] - 2020-11-17
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.193 Safari/537.36
Start time: 15:08:29
PCBA_SITE: FOL
BU: ERBU
File 3a4: backlog3a4-detail (33).csv(size: 83.6Mb)
File supply: SCR_OH_Intransit 11-10 1514.xlsx(size: 1.6Mb)
ERROR!!!!15:09:15Traceback (most recent call last):
  File "/Users/wangken/py/pcba_allocation/wsgi.py", line 117, in allocation_run
    output_filename=pcba_allocation_main_program(df_3a4, df_oh, df_transit, df_scr, pcba_site, bu_list, ranking_col)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 1181, in pcba_allocation_main_program
    df_scr = process_final_allocated_output(df_scr, tan_bu, df_3a4, df_oh, df_transit, pcba_site)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 1001, in process_final_allocated_output
    tan_allocation_wk=calculate_x_weeks_allocation(df_scr, pcba_site, wk='wk0')
  File "/Users/wangken/py/pcba_allocation/functions.py", line 941, in calculate_x_weeks_allocation
    if date>supply_cut_off:
TypeError: '>' not supported between instances of 'str' and 'datetime.date'


[Making allocation] - 2020-11-17
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.193 Safari/537.36
Start time: 15:24:11
PCBA_SITE: FOL
BU: ERBU
File 3a4: backlog3a4-detail (33).csv(size: 83.6Mb)
File supply: SCR_OH_Intransit 11-10 1514.xlsx(size: 1.6Mb)
ERROR!!!!15:25:03Traceback (most recent call last):
  File "/Users/wangken/py/pcba_allocation/wsgi.py", line 117, in allocation_run
    output_filename=pcba_allocation_main_program(df_3a4, df_oh, df_transit, df_scr, pcba_site, bu_list, ranking_col)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 1181, in pcba_allocation_main_program
    df_scr = process_final_allocated_output(df_scr, tan_bu, df_3a4, df_oh, df_transit, pcba_site)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 1001, in process_final_allocated_output
    tan_allocation_wk=calculate_x_weeks_allocation(df_scr, pcba_site, wk='wk0')
  File "/Users/wangken/py/pcba_allocation/functions.py", line 941, in calculate_x_weeks_allocation
    if date>supply_cut_off:
TypeError: '>' not supported between instances of 'str' and 'datetime.date'


[Making allocation] - 2020-11-17
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.193 Safari/537.36
Start time: 15:26:05
PCBA_SITE: FOL
BU: ERBU
File 3a4: backlog3a4-detail (33).csv(size: 83.6Mb)
File supply: SCR_OH_Intransit 11-10 1514.xlsx(size: 1.6Mb)
ERROR!!!!15:26:57Traceback (most recent call last):
  File "/Users/wangken/py/pcba_allocation/wsgi.py", line 117, in allocation_run
    output_filename=pcba_allocation_main_program(df_3a4, df_oh, df_transit, df_scr, pcba_site, bu_list, ranking_col)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 1181, in pcba_allocation_main_program
    df_scr = process_final_allocated_output(df_scr, tan_bu, df_3a4, df_oh, df_transit, pcba_site)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 1001, in process_final_allocated_output
    tan_allocation_wk=calculate_x_weeks_allocation(df_scr, pcba_site, wk='wk0')
  File "/Users/wangken/py/pcba_allocation/functions.py", line 941, in calculate_x_weeks_allocation
    if date>supply_cut_off:
TypeError: '>' not supported between instances of 'str' and 'datetime.date'


[Making allocation] - 2020-11-17
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.193 Safari/537.36
Start time: 15:29:28
PCBA_SITE: FOL
BU: ERBU
File 3a4: backlog3a4-detail (33).csv(size: 83.6Mb)
File supply: SCR_OH_Intransit 11-10 1514.xlsx(size: 1.6Mb)
ERROR!!!!15:30:19Traceback (most recent call last):
  File "/Users/wangken/py/pcba_allocation/wsgi.py", line 117, in allocation_run
    output_filename=pcba_allocation_main_program(df_3a4, df_oh, df_transit, df_scr, pcba_site, bu_list, ranking_col)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 1181, in pcba_allocation_main_program
    df_scr = process_final_allocated_output(df_scr, tan_bu, df_3a4, df_oh, df_transit, pcba_site)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 1001, in process_final_allocated_output
    tan_allocation_wk=calculate_x_weeks_allocation(df_scr, pcba_site, wk='wk0')
  File "/Users/wangken/py/pcba_allocation/functions.py", line 942, in calculate_x_weeks_allocation
    ind=dfx.columns.index(date)-1
AttributeError: 'Index' object has no attribute 'index'


[Making allocation] - 2020-11-17
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.193 Safari/537.36
Start time: 15:31:56
PCBA_SITE: FOL
BU: ERBU
File 3a4: backlog3a4-detail (33).csv(size: 83.6Mb)
File supply: SCR_OH_Intransit 11-10 1514.xlsx(size: 1.6Mb)
ERROR!!!!15:32:51Traceback (most recent call last):
  File "/Users/wangken/py/pcba_allocation/wsgi.py", line 117, in allocation_run
    output_filename=pcba_allocation_main_program(df_3a4, df_oh, df_transit, df_scr, pcba_site, bu_list, ranking_col)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 1181, in pcba_allocation_main_program
    df_scr = process_final_allocated_output(df_scr, tan_bu, df_3a4, df_oh, df_transit, pcba_site)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 1001, in process_final_allocated_output
    tan_allocation_wk=calculate_x_weeks_allocation(df_scr, pcba_site, wk='wk0')
  File "/Users/wangken/py/pcba_allocation/functions.py", line 942, in calculate_x_weeks_allocation
    ind=dfx.columns.index(date)-1
AttributeError: 'Index' object has no attribute 'index'


[Making allocation] - 2020-11-17
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.193 Safari/537.36
Start time: 15:50:08
PCBA_SITE: FOL
BU: ERBU
File 3a4: backlog3a4-detail (33).csv(size: 83.6Mb)
File supply: SCR_OH_Intransit 11-10 1514.xlsx(size: 1.6Mb)
ERROR!!!!15:50:52Traceback (most recent call last):
  File "/Users/wangken/py/pcba_allocation/wsgi.py", line 117, in allocation_run
    output_filename=pcba_allocation_main_program(df_3a4, df_oh, df_transit, df_scr, pcba_site, bu_list, ranking_col)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 1181, in pcba_allocation_main_program
    df_scr = process_final_allocated_output(df_scr, tan_bu, df_3a4, df_oh, df_transit, pcba_site)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 1001, in process_final_allocated_output
    tan_allocation_wk=calculate_x_weeks_allocation(df_scr, pcba_site, wk='wk0')
  File "/Users/wangken/py/pcba_allocation/functions.py", line 942, in calculate_x_weeks_allocation
    ind=dfx.columns.index(date)-1
AttributeError: 'Index' object has no attribute 'index'


[Making allocation] - 2020-11-17
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.193 Safari/537.36
Start time: 15:53:11
PCBA_SITE: FOL
BU: ERBU
File 3a4: backlog3a4-detail (33).csv(size: 83.6Mb)
File supply: SCR_OH_Intransit 11-10 1514.xlsx(size: 1.6Mb)
ERROR!!!!15:54:00Traceback (most recent call last):
  File "/Users/wangken/py/pcba_allocation/wsgi.py", line 117, in allocation_run
    output_filename=pcba_allocation_main_program(df_3a4, df_oh, df_transit, df_scr, pcba_site, bu_list, ranking_col)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 1181, in pcba_allocation_main_program
    df_scr = process_final_allocated_output(df_scr, tan_bu, df_3a4, df_oh, df_transit, pcba_site)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 1001, in process_final_allocated_output
    tan_allocation_wk=calculate_x_weeks_allocation(df_scr, pcba_site, wk='wk0')
  File "/Users/wangken/py/pcba_allocation/functions.py", line 949, in calculate_x_weeks_allocation
    key=(row.BOM_PN,row.ORGANIZATION_CODE,row.BUSINESS_UNIT)
AttributeError: 'Pandas' object has no attribute 'BOM_PN'


[Making allocation] - 2020-11-17
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.193 Safari/537.36
Start time: 15:57:11
PCBA_SITE: FOL
BU: ERBU
File 3a4: backlog3a4-detail (33).csv(size: 83.6Mb)
File supply: SCR_OH_Intransit 11-10 1514.xlsx(size: 1.6Mb)
ERROR!!!!15:57:56Traceback (most recent call last):
  File "/Users/wangken/py/pcba_allocation/wsgi.py", line 117, in allocation_run
    output_filename=pcba_allocation_main_program(df_3a4, df_oh, df_transit, df_scr, pcba_site, bu_list, ranking_col)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 1181, in pcba_allocation_main_program
    df_scr = process_final_allocated_output(df_scr, tan_bu, df_3a4, df_oh, df_transit, pcba_site)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 1001, in process_final_allocated_output
    tan_allocation_wk=calculate_x_weeks_allocation(df_scr, pcba_site, wk='wk0')
  File "/Users/wangken/py/pcba_allocation/functions.py", line 949, in calculate_x_weeks_allocation
    key=(row.TAN,row.ORG,row.BU)
AttributeError: 'Pandas' object has no attribute 'TAN'


[Making allocation] - 2020-11-17
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.193 Safari/537.36
Start time: 16:00:12
PCBA_SITE: FOL
BU: ERBU
File 3a4: backlog3a4-detail (33).csv(size: 83.6Mb)
File supply: SCR_OH_Intransit 11-10 1514.xlsx(size: 1.6Mb)
ERROR!!!!16:00:57Traceback (most recent call last):
  File "/Users/wangken/py/pcba_allocation/wsgi.py", line 117, in allocation_run
    output_filename=pcba_allocation_main_program(df_3a4, df_oh, df_transit, df_scr, pcba_site, bu_list, ranking_col)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 1180, in pcba_allocation_main_program
    df_scr = process_final_allocated_output(df_scr, tan_bu, df_3a4, df_oh, df_transit, pcba_site)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 1000, in process_final_allocated_output
    tan_allocation_wk=calculate_x_weeks_allocation(df_scr, pcba_site, wk='wk0')
  File "/Users/wangken/py/pcba_allocation/functions.py", line 948, in calculate_x_weeks_allocation
    key=(row.index[0],row.index[1],row.index[2])
TypeError: 'builtin_function_or_method' object is not subscriptable


[Making allocation] - 2020-11-17
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.193 Safari/537.36
Start time: 16:01:47
PCBA_SITE: FOL
BU: ERBU
File 3a4: backlog3a4-detail (33).csv(size: 83.6Mb)
File supply: SCR_OH_Intransit 11-10 1514.xlsx(size: 1.6Mb)
ERROR!!!!16:02:31Traceback (most recent call last):
  File "/Users/wangken/py/pcba_allocation/wsgi.py", line 117, in allocation_run
    output_filename=pcba_allocation_main_program(df_3a4, df_oh, df_transit, df_scr, pcba_site, bu_list, ranking_col)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 1181, in pcba_allocation_main_program
    df_scr = process_final_allocated_output(df_scr, tan_bu, df_3a4, df_oh, df_transit, pcba_site)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 1001, in process_final_allocated_output
    tan_allocation_wk=calculate_x_weeks_allocation(df_scr, pcba_site, wk='wk0')
  File "/Users/wangken/py/pcba_allocation/functions.py", line 949, in calculate_x_weeks_allocation
    key=(row.index[0],row.index[1],row.index[2])
TypeError: 'builtin_function_or_method' object is not subscriptable


[Making allocation] - 2020-11-17
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.193 Safari/537.36
Start time: 16:03:51
PCBA_SITE: FOL
BU: ERBU
File 3a4: backlog3a4-detail (33).csv(size: 83.6Mb)
File supply: SCR_OH_Intransit 11-10 1514.xlsx(size: 1.6Mb)
ERROR!!!!16:04:45Traceback (most recent call last):
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/indexes/base.py", line 666, in astype
    casted = self._values.astype(dtype, copy=copy)
ValueError: Error parsing datetime string "index" at position 0

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/wangken/py/pcba_allocation/wsgi.py", line 117, in allocation_run
    output_filename=pcba_allocation_main_program(df_3a4, df_oh, df_transit, df_scr, pcba_site, bu_list, ranking_col)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 1181, in pcba_allocation_main_program
  File "/Users/wangken/py/pcba_allocation/functions.py", line 1004, in process_final_allocated_output
    tan_allocation_wk = calculate_x_weeks_allocation(df_scr, pcba_site, wk='wk1')
  File "/Users/wangken/py/pcba_allocation/functions.py", line 936, in calculate_x_weeks_allocation
    date_col=dfx.iloc[:,:-6].columns.astype('datetime64[ns]').tolist()
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/indexes/base.py", line 670, in astype
    ) from err
TypeError: Cannot cast Index to dtype datetime64[ns]


[Making allocation] - 2020-11-17
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.193 Safari/537.36
Start time: 16:09:17
PCBA_SITE: FOL
BU: ERBU
File 3a4: backlog3a4-detail (33).csv(size: 83.6Mb)
File supply: SCR_OH_Intransit 11-10 1514.xlsx(size: 1.6Mb)
ERROR!!!!16:10:11Traceback (most recent call last):
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/indexes/base.py", line 666, in astype
    casted = self._values.astype(dtype, copy=copy)
ValueError: Error parsing datetime string "Unpacked_blg" at position 0

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/wangken/py/pcba_allocation/wsgi.py", line 117, in allocation_run
    output_filename=pcba_allocation_main_program(df_3a4, df_oh, df_transit, df_scr, pcba_site, bu_list, ranking_col)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 1176, in pcba_allocation_main_program
    # 把以下信息加回scr: BU, backlog, OH, intransit; 并做相应的计算处理
  File "/Users/wangken/py/pcba_allocation/functions.py", line 1000, in process_final_allocated_output
    lambda x: tan_allocation_wk[x] if x in tan_allocation_wk.keys() else None)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 933, in calculate_x_weeks_allocation
    # find out the col of cutoff
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/indexes/base.py", line 670, in astype
    ) from err
TypeError: Cannot cast Index to dtype datetime64[ns]


[Making allocation] - 2020-11-17
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.193 Safari/537.36
Start time: 16:11:39
PCBA_SITE: FOL
BU: ERBU
File 3a4: backlog3a4-detail (33).csv(size: 83.6Mb)
File supply: SCR_OH_Intransit 11-10 1514.xlsx(size: 1.6Mb)
ERROR!!!!16:12:23Traceback (most recent call last):
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/indexes/base.py", line 666, in astype
    casted = self._values.astype(dtype, copy=copy)
ValueError: Error parsing datetime string "Unpacked_blg" at position 0

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/wangken/py/pcba_allocation/wsgi.py", line 117, in allocation_run
    output_filename=pcba_allocation_main_program(df_3a4, df_oh, df_transit, df_scr, pcba_site, bu_list, ranking_col)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 1178, in pcba_allocation_main_program
    df_scr = process_final_allocated_output(df_scr, tan_bu, df_3a4, df_oh, df_transit, pcba_site)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 1002, in process_final_allocated_output
    tan_allocation_wk = calculate_x_weeks_allocation(df_scr, pcba_site, wk='wk1')
  File "/Users/wangken/py/pcba_allocation/functions.py", line 935, in calculate_x_weeks_allocation
    date_col=df_scr.iloc[:,:-6].columns.astype('datetime64[ns]').tolist()
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/indexes/base.py", line 670, in astype
    ) from err
TypeError: Cannot cast Index to dtype datetime64[ns]


[Making allocation] - 2020-11-17
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.193 Safari/537.36
Start time: 16:13:25
PCBA_SITE: FOL
BU: ERBU
File 3a4: backlog3a4-detail (33).csv(size: 83.6Mb)
File supply: SCR_OH_Intransit 11-10 1514.xlsx(size: 1.6Mb)
ERROR!!!!16:14:10Traceback (most recent call last):
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/indexes/base.py", line 666, in astype
    casted = self._values.astype(dtype, copy=copy)
ValueError: Error parsing datetime string "Unpacked_blg" at position 0

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/wangken/py/pcba_allocation/wsgi.py", line 117, in allocation_run
    output_filename=pcba_allocation_main_program(df_3a4, df_oh, df_transit, df_scr, pcba_site, bu_list, ranking_col)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 1178, in pcba_allocation_main_program
    df_scr = process_final_allocated_output(df_scr, tan_bu, df_3a4, df_oh, df_transit, pcba_site)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 1005, in process_final_allocated_output
    tan_allocation_wk = calculate_x_weeks_allocation(df_scr, pcba_site, wk='wk2')
  File "/Users/wangken/py/pcba_allocation/functions.py", line 935, in calculate_x_weeks_allocation
    date_col=df_scr.iloc[:,:-7].columns.astype('datetime64[ns]').tolist()
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/indexes/base.py", line 670, in astype
    ) from err
TypeError: Cannot cast Index to dtype datetime64[ns]


[Making allocation] - 2020-11-17
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.193 Safari/537.36
Start time: 16:17:51
PCBA_SITE: FOL
BU: ERBU
File 3a4: backlog3a4-detail (33).csv(size: 83.6Mb)
File supply: SCR_OH_Intransit 11-10 1514.xlsx(size: 1.6Mb)
ERROR!!!!16:18:35Traceback (most recent call last):
  File "/Users/wangken/py/pcba_allocation/wsgi.py", line 117, in allocation_run
    output_filename=pcba_allocation_main_program(df_3a4, df_oh, df_transit, df_scr, pcba_site, bu_list, ranking_col)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 1177, in pcba_allocation_main_program
    df_scr = process_final_allocated_output(df_scr, tan_bu, df_3a4, df_oh, df_transit, pcba_site)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 1011, in process_final_allocated_output
    df_scr.loc[:, 'Gap_before'] = np.where(df_scr.ORG != pcba_site,
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/generic.py", line 5139, in __getattr__
    return object.__getattribute__(self, name)
AttributeError: 'DataFrame' object has no attribute 'ORG'


[Making allocation] - 2020-11-17
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.193 Safari/537.36
Start time: 16:20:28
PCBA_SITE: FOL
BU: ERBU
File 3a4: backlog3a4-detail (33).csv(size: 83.6Mb)
File supply: SCR_OH_Intransit 11-10 1514.xlsx(size: 1.6Mb)
Finish time: 16:21:16

[Making allocation] - 2020-11-17
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.193 Safari/537.36
Start time: 16:29:02
PCBA_SITE: FOL
BU: ERBU
File 3a4: backlog3a4-detail (33).csv(size: 83.6Mb)
File supply: SCR_OH_Intransit 11-10 1514.xlsx(size: 1.6Mb)
Finish time: 16:29:52

[Making allocation] - 2020-11-17
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.193 Safari/537.36
Start time: 17:00:09
PCBA_SITE: FOL
BU: ERBU
File 3a4: backlog3a4-detail (33).csv(size: 83.6Mb)
File supply: SCR_OH_Intransit 11-10 1514.xlsx(size: 1.6Mb)
Finish time: 17:01:05

[Making allocation] - 2020-11-17
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.193 Safari/537.36
Start time: 17:26:16
PCBA_SITE: FOL
BU: ERBU
File 3a4: backlog3a4-detail (33).csv(size: 83.6Mb)
File supply: SCR_OH_Intransit 11-10 1514.xlsx(size: 1.6Mb)
ERROR!!!!17:27:09Traceback (most recent call last):
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/indexes/base.py", line 666, in astype
    casted = self._values.astype(dtype, copy=copy)
ValueError: Error parsing datetime string "index" at position 0

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/wangken/py/pcba_allocation/wsgi.py", line 117, in allocation_run
    output_filename=pcba_allocation_main_program(df_3a4, df_oh, df_transit, df_scr, pcba_site, bu_list, ranking_col)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 1174, in pcba_allocation_main_program
    df_scr = process_final_allocated_output(df_scr, tan_bu, df_3a4, df_oh, df_transit, pcba_site)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 1020, in process_final_allocated_output
    tan_allocation_wk0 = calculate_x_weeks_allocation(df_scr, pcba_site, wk='wk0')
  File "/Users/wangken/py/pcba_allocation/functions.py", line 934, in calculate_x_weeks_allocation
    date_col=df_scr.iloc[:,:-10].columns.astype('datetime64[ns]').tolist()
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/indexes/base.py", line 670, in astype
    ) from err
TypeError: Cannot cast Index to dtype datetime64[ns]


[Making allocation] - 2020-11-17
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.193 Safari/537.36
Start time: 17:28:01
PCBA_SITE: FOL
BU: ERBU
File 3a4: backlog3a4-detail (33).csv(size: 83.6Mb)
File supply: SCR_OH_Intransit 11-10 1514.xlsx(size: 1.6Mb)
ERROR!!!!17:28:56Traceback (most recent call last):
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/indexes/base.py", line 666, in astype
    casted = self._values.astype(dtype, copy=copy)
ValueError: Error parsing datetime string "index" at position 0

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/wangken/py/pcba_allocation/wsgi.py", line 117, in allocation_run
    output_filename=pcba_allocation_main_program(df_3a4, df_oh, df_transit, df_scr, pcba_site, bu_list, ranking_col)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 1174, in pcba_allocation_main_program
    df_scr = process_final_allocated_output(df_scr, tan_bu, df_3a4, df_oh, df_transit, pcba_site)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 1020, in process_final_allocated_output
    tan_allocation_wk0 = calculate_x_weeks_allocation(df_scr, pcba_site, wk='wk0')
  File "/Users/wangken/py/pcba_allocation/functions.py", line 934, in calculate_x_weeks_allocation
    date_col=df_scr.iloc[:,:-10].columns.astype('datetime64[ns]').tolist()
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/indexes/base.py", line 670, in astype
    ) from err
TypeError: Cannot cast Index to dtype datetime64[ns]


[Making allocation] - 2020-11-17
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.193 Safari/537.36
Start time: 17:30:49
PCBA_SITE: FOL
BU: ERBU
File 3a4: backlog3a4-detail (33).csv(size: 83.6Mb)
File supply: SCR_OH_Intransit 11-10 1514.xlsx(size: 1.6Mb)
ERROR!!!!17:31:42Traceback (most recent call last):
  File "/Users/wangken/py/pcba_allocation/wsgi.py", line 117, in allocation_run
    output_filename=pcba_allocation_main_program(df_3a4, df_oh, df_transit, df_scr, pcba_site, bu_list, ranking_col)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 1172, in pcba_allocation_main_program
    df_scr = process_final_allocated_output(df_scr, tan_bu, df_3a4, df_oh, df_transit, pcba_site)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 1032, in process_final_allocated_output
    inplace=True)
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/frame.py", line 4551, in set_index
    raise KeyError(f"None of {missing} are in the columns")
KeyError: "None of ['TAN', 'ORG', 'BU'] are in the columns"


[Making allocation] - 2020-11-17
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.193 Safari/537.36
Start time: 17:33:12
PCBA_SITE: FOL
BU: ERBU
File 3a4: backlog3a4-detail (33).csv(size: 83.6Mb)
File supply: SCR_OH_Intransit 11-10 1514.xlsx(size: 1.6Mb)
Finish time: 17:34:06

[Making allocation] - 2020-11-17
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.193 Safari/537.36
Start time: 17:39:23
PCBA_SITE: FOL
BU: ERBU
File 3a4: backlog3a4-detail (33).csv(size: 83.6Mb)
File supply: SCR_OH_Intransit 11-10 1514.xlsx(size: 1.6Mb)
Finish time: 17:40:18

[Making allocation] - 2020-11-17
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.193 Safari/537.36
Start time: 17:51:14
PCBA_SITE: FOL
BU: ERBU
File 3a4: backlog3a4-detail (33).csv(size: 83.6Mb)
File supply: SCR_OH_Intransit 11-10 1514.xlsx(size: 1.6Mb)
Finish time: 17:52:14

[Making allocation] - 2020-11-17
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.193 Safari/537.36
Start time: 18:03:37
PCBA_SITE: FOL
BU: ERBU
File 3a4: backlog3a4-detail (33).csv(size: 83.6Mb)
File supply: SCR_OH_Intransit 11-10 1514.xlsx(size: 1.6Mb)
ERROR!!!!18:04:39Traceback (most recent call last):
  File "/Users/wangken/py/pcba_allocation/wsgi.py", line 117, in allocation_run
    output_filename=pcba_allocation_main_program(df_3a4, df_oh, df_transit, df_scr, pcba_site, bu_list, ranking_col)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 1177, in pcba_allocation_main_program
    df_scr = process_final_allocated_output(df_scr, tan_bu, df_3a4, df_oh, df_transit, pcba_site)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 1044, in process_final_allocated_output
    dfy = dfx.loc[ind, :-9] # -9 to excluded the last added columns
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/indexing.py", line 873, in __getitem__
    return self._getitem_tuple(key)
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/indexing.py", line 1044, in _getitem_tuple
    return self._getitem_lowerdim(tup)
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/indexing.py", line 766, in _getitem_lowerdim
    return self._getitem_nested_tuple(tup)
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/indexing.py", line 847, in _getitem_nested_tuple
    obj = getattr(obj, self.name)._getitem_axis(key, axis=axis)
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/indexing.py", line 1088, in _getitem_axis
    return self._get_slice_axis(key, axis=axis)
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/indexing.py", line 1123, in _get_slice_axis
    slice_obj.start, slice_obj.stop, slice_obj.step, kind="loc"
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/indexes/base.py", line 4966, in slice_indexer
    start_slice, end_slice = self.slice_locs(start, end, step=step, kind=kind)
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/indexes/base.py", line 5173, in slice_locs
    end_slice = self.get_slice_bound(end, "right", kind)
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/indexes/base.py", line 5079, in get_slice_bound
    label = self._maybe_cast_slice_bound(label, side, kind)
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/indexes/base.py", line 5031, in _maybe_cast_slice_bound
    self._invalid_indexer("slice", label)
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/indexes/base.py", line 3268, in _invalid_indexer
    f"cannot do {form} indexing on {type(self).__name__} with these "
TypeError: cannot do slice indexing on Index with these indexers [-9] of type int


[Making allocation] - 2020-11-17
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.193 Safari/537.36
Start time: 18:06:31
PCBA_SITE: FOL
BU: ERBU
File 3a4: backlog3a4-detail (33).csv(size: 83.6Mb)
File supply: SCR_OH_Intransit 11-10 1514.xlsx(size: 1.6Mb)
Finish time: 18:07:26

[Making allocation] - 2020-11-18
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.198 Safari/537.36
Start time: 08:24:11
PCBA_SITE: FOL
BU: 
File 3a4: backlog3a4-detail3 (1).csv(size: 83.6Mb)
File supply: SCR_OH_Intransit_1117.xlsx(size: 1.4Mb)
Finish time: 08:26:48

[Making allocation] - 2020-11-18
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.198 Safari/537.36
Start time: 08:38:57
PCBA_SITE: FOL
BU: 
File 3a4: backlog3a4-detail3 (1).csv(size: 83.6Mb)
File supply: SCR_OH_Intransit_1117.xlsx(size: 1.4Mb)
Finish time: 08:41:14

[Making allocation] - 2020-11-18
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.198 Safari/537.36
Start time: 08:46:27
PCBA_SITE: FOL
BU: ERBU
File 3a4: backlog3a4-detail3 (1).csv(size: 83.6Mb)
File supply: SCR_OH_Intransit_1117.xlsx(size: 1.4Mb)
Finish time: 08:47:14

[Making allocation] - 2020-11-18
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.198 Safari/537.36
Start time: 08:49:02
PCBA_SITE: FOL
BU: 
File 3a4: backlog3a4-detail3 (1).csv(size: 83.6Mb)
File supply: SCR_OH_Intransit_1117.xlsx(size: 1.4Mb)
Finish time: 08:51:10

[Download/delete file] - 2020-11-19 16:06:06
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.198 Safari/537.36
Download supply from DB

[Making allocation] - 2020-11-20
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.198 Safari/537.36
Start time: 14:31:42
PCBA_SITE: FOL
BU: 
File 3a4: backlog3a4-detail3 (1).csv(size: 83.6Mb)
File supply: SCR_OH_Intransit_1117.xlsx(size: 1.4Mb)
Finish time: 14:34:08

[Making allocation] - 2020-11-20
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.198 Safari/537.36
Start time: 14:41:47
PCBA_SITE: FOL
BU: 
File 3a4: backlog3a4-detail3 (1).csv(size: 83.6Mb)
File supply: SCR_OH_Intransit_1117.xlsx(size: 1.4Mb)
ERROR!!!!14:43:11Traceback (most recent call last):
  File "/Users/wangken/py/pcba_allocation/wsgi.py", line 117, in allocation_run
    output_filename=pcba_allocation_main_program(df_3a4, df_oh, df_transit, df_scr, pcba_site, bu_list, ranking_col)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 1165, in pcba_allocation_main_program
    df_transit.columns = df_transit.columns.map(lambda x: x.date())
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/indexes/base.py", line 4794, in map
    new_values = super()._map_values(mapper, na_action=na_action)
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/base.py", line 1160, in _map_values
    new_values = map_f(values, mapper)
  File "pandas/_libs/lib.pyx", line 2402, in pandas._libs.lib.map_infer
  File "/Users/wangken/py/pcba_allocation/functions.py", line 1165, in <lambda>
    df_transit.columns = df_transit.columns.map(lambda x: x.date())
AttributeError: 'str' object has no attribute 'date'


[Making allocation] - 2020-11-20
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.198 Safari/537.36
Start time: 14:45:52
PCBA_SITE: FOL
BU: 
File 3a4: backlog3a4-detail3 (1).csv(size: 83.6Mb)
File supply: SCR_OH_Intransit_1117.xlsx(size: 1.4Mb)
Finish time: 14:48:12

[Making allocation] - 2020-11-20
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.198 Safari/537.36
Start time: 14:51:18
PCBA_SITE: FOL
BU: 
File 3a4: backlog3a4-detail3 (1).csv(size: 83.6Mb)
File supply: SCR_OH_Intransit_1117.xlsx(size: 1.4Mb)
Finish time: 14:53:50