
[2020-10-23 14:27:00]
Traceback (most recent call last):
  File "/Users/wangken/py/pcba_allocation/wsgi.py", line 109, in allocation_run
    output_filename=pcba_allocation_main_program(df_3a4, df_oh, df_transit, df_scr, pcba_site, bu_list, ranking_col)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 860, in pcba_allocation_main_program
    ss_priority=read_backlog_priority_from_smartsheet(smartsheet_client, sheet_id)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 22, in read_backlog_priority_from_smartsheet
    df_smart.Ranking=df_smart.Ranking.astype(int)
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/generic.py", line 5546, in astype
    new_data = self._mgr.astype(dtype=dtype, copy=copy, errors=errors,)
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/internals/managers.py", line 595, in astype
    return self.apply("astype", dtype=dtype, copy=copy, errors=errors)
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/internals/managers.py", line 406, in apply
    applied = getattr(b, f)(**kwargs)
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/internals/blocks.py", line 595, in astype
    values = astype_nansafe(vals1d, dtype, copy=True)
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/dtypes/cast.py", line 972, in astype_nansafe
    return lib.astype_intsafe(arr.ravel(), dtype).reshape(arr.shape)
  File "pandas/_libs/lib.pyx", line 614, in pandas._libs.lib.astype_intsafe
ValueError: invalid literal for int() with base 10: '1.6'

[2020-10-23 14:31:43]
Traceback (most recent call last):
  File "/Users/wangken/py/pcba_allocation/wsgi.py", line 109, in allocation_run
    output_filename=pcba_allocation_main_program(df_3a4, df_oh, df_transit, df_scr, pcba_site, bu_list, ranking_col)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 860, in pcba_allocation_main_program
    ss_priority=read_backlog_priority_from_smartsheet(smartsheet_client, sheet_id)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 22, in read_backlog_priority_from_smartsheet
    df_smart.Ranking=df_smart.Ranking.astype(float)
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/generic.py", line 5546, in astype
    new_data = self._mgr.astype(dtype=dtype, copy=copy, errors=errors,)
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/internals/managers.py", line 595, in astype
    return self.apply("astype", dtype=dtype, copy=copy, errors=errors)
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/internals/managers.py", line 406, in apply
    applied = getattr(b, f)(**kwargs)
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/internals/blocks.py", line 595, in astype
    values = astype_nansafe(vals1d, dtype, copy=True)
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/dtypes/cast.py", line 995, in astype_nansafe
    return arr.astype(dtype, copy=True)
ValueError: could not convert string to float: 'a'

[2020-10-23 14:41:44]
Traceback (most recent call last):
  File "/Users/wangken/py/pcba_allocation/wsgi.py", line 109, in allocation_run
    output_filename=pcba_allocation_main_program(df_3a4, df_oh, df_transit, df_scr, pcba_site, bu_list, ranking_col)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 926, in pcba_allocation_main_program
    output_filename = write_excel_output_file(bu_list, df_scr, df_3a4, df_transit)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 680, in write_excel_output_file
    df_3a4 = df_3a4[df_3a4.BOM_PN.notnull()][output_col_3a4].copy()
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/frame.py", line 2908, in __getitem__
    indexer = self.loc._get_listlike_indexer(key, axis=1, raise_missing=True)[1]
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/indexing.py", line 1254, in _get_listlike_indexer
    self._validate_read_indexer(keyarr, indexer, axis, raise_missing=raise_missing)
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/indexing.py", line 1304, in _validate_read_indexer
    raise KeyError(f"{not_found} not in index")
KeyError: "['priority_ranking_temp'] not in index"

[2020-10-23 14:51:21]
Traceback (most recent call last):
  File "/Users/wangken/py/pcba_allocation/wsgi.py", line 109, in allocation_run
    output_filename=pcba_allocation_main_program(df_3a4, df_oh, df_transit, df_scr, pcba_site, bu_list, ranking_col)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 869, in pcba_allocation_main_program
    df_3a4 = ss_ranking_overall_new(df_3a4, ss_priority, ranking_col, order_col='SO_SS', new_col='ss_overall_rank')
  File "/Users/wangken/py/pcba_allocation/functions.py", line 636, in ss_ranking_overall_new
    ss_priority[df_3a4.SO_SS],
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/generic.py", line 1669, in __hash__
    f"{repr(type(self).__name__)} objects are mutable, "
TypeError: 'Series' objects are mutable, thus they cannot be hashed

[2020-10-23 14:55:56]
Traceback (most recent call last):
  File "/Users/wangken/py/pcba_allocation/wsgi.py", line 109, in allocation_run
    output_filename=pcba_allocation_main_program(df_3a4, df_oh, df_transit, df_scr, pcba_site, bu_list, ranking_col)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 930, in pcba_allocation_main_program
    output_filename = write_excel_output_file(bu_list, df_scr, df_3a4, df_transit)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 684, in write_excel_output_file
    df_3a4 = df_3a4[df_3a4.BOM_PN.notnull()][output_col_3a4].copy()
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/frame.py", line 2908, in __getitem__
    indexer = self.loc._get_listlike_indexer(key, axis=1, raise_missing=True)[1]
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/indexing.py", line 1254, in _get_listlike_indexer
    self._validate_read_indexer(keyarr, indexer, axis, raise_missing=raise_missing)
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/indexing.py", line 1304, in _validate_read_indexer
    raise KeyError(f"{not_found} not in index")
KeyError: "['priority_rank_temp'] not in index"

[2020-10-27 10:58:35]
Traceback (most recent call last):
  File "/Users/wangken/py/pcba_allocation/wsgi.py", line 109, in allocation_run
    output_filename=pcba_allocation_main_program(df_3a4, df_oh, df_transit, df_scr, pcba_site, bu_list, ranking_col)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 914, in pcba_allocation_main_program
    ss_priority=read_backlog_priority_from_smartsheet()
  File "/Users/wangken/py/pcba_allocation/functions.py", line 20, in read_backlog_priority_from_smartsheet
    smartsheet_client = SmartSheetClient(token, proxies)
  File "/Users/wangken/py/pcba_allocation/smartsheet_handler.py", line 12, in __init__
    self.smartsheet_client = smartsheet.Smartsheet(access_token=access_token, proxies=proxies)
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/smartsheet/smartsheet.py", line 145, in __init__
    raise ValueError('Access Token must be set in the environment '
ValueError: Access Token must be set in the environment or passed to smartsheet.Smartsheet() as a parameter.

[2020-10-28 11:51:58]
Traceback (most recent call last):
  File "/Users/wangken/py/pcba_allocation/wsgi.py", line 103, in allocation_run
    output_filename=pcba_allocation_main_program(df_3a4, df_oh, df_transit, df_scr, pcba_site, bu_list, ranking_col)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 973, in pcba_allocation_main_program
    df_scr = process_final_allocated_output(df_scr, tan_bu, df_3a4, df_oh, df_transit, pcba_site)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 497, in process_final_allocated_output
    df_scr['oh+transit'] - df_scr.Backlog,
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/generic.py", line 5139, in __getattr__
    return object.__getattribute__(self, name)
AttributeError: 'DataFrame' object has no attribute 'Backlog'

[2020-10-28 11:58:19]
Traceback (most recent call last):
  File "/Users/wangken/py/pcba_allocation/wsgi.py", line 103, in allocation_run
    output_filename=pcba_allocation_main_program(df_3a4, df_oh, df_transit, df_scr, pcba_site, bu_list, ranking_col)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 973, in pcba_allocation_main_program
    df_scr = process_final_allocated_output(df_scr, tan_bu, df_3a4, df_oh, df_transit, pcba_site)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 497, in process_final_allocated_output
    df_scr['oh+transit'] - df_scr.Unpacked_blg,
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/pandas/core/generic.py", line 5139, in __getattr__
    return object.__getattribute__(self, name)
AttributeError: 'DataFrame' object has no attribute 'Unpacked_blg'

[2020-10-29 09:07:47]
Traceback (most recent call last):
  File "/Users/wangken/py/pcba_allocation/wsgi.py", line 103, in allocation_run
    output_filename=pcba_allocation_main_program(df_3a4, df_oh, df_transit, df_scr, pcba_site, bu_list, ranking_col)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 912, in pcba_allocation_main_program
    ss_priority=read_backlog_priority_from_smartsheet()
  File "/Users/wangken/py/pcba_allocation/functions.py", line 20, in read_backlog_priority_from_smartsheet
    smartsheet_client = SmartSheetClient(token, proxies)
  File "/Users/wangken/py/pcba_allocation/smartsheet_handler.py", line 12, in __init__
    self.smartsheet_client = smartsheet.Smartsheet(access_token=access_token, proxies=proxies)
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/smartsheet/smartsheet.py", line 145, in __init__
    raise ValueError('Access Token must be set in the environment '
ValueError: Access Token must be set in the environment or passed to smartsheet.Smartsheet() as a parameter.

[2020-11-02 14:08:47]
Traceback (most recent call last):
  File "/Users/wangken/py/pcba_allocation/wsgi.py", line 101, in allocation_run
    output_filename=pcba_allocation_main_program(df_3a4, df_oh, df_transit, df_scr, pcba_site, bu_list, ranking_col)
  File "/Users/wangken/py/pcba_allocation/functions.py", line 912, in pcba_allocation_main_program
    ss_priority=read_backlog_priority_from_smartsheet()
  File "/Users/wangken/py/pcba_allocation/functions.py", line 20, in read_backlog_priority_from_smartsheet
    smartsheet_client = SmartSheetClient(token, proxies)
  File "/Users/wangken/py/pcba_allocation/smartsheet_handler.py", line 12, in __init__
    self.smartsheet_client = smartsheet.Smartsheet(access_token=access_token, proxies=proxies)
  File "/Users/wangken/.local/share/virtualenvs/pcba_allocation-lWAyiP-1/lib/python3.7/site-packages/smartsheet/smartsheet.py", line 145, in __init__
    raise ValueError('Access Token must be set in the environment '
ValueError: Access Token must be set in the environment or passed to smartsheet.Smartsheet() as a parameter.

User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36
2020-11-02 14:26:36
PCBA_SITE: FOL
BU: ERBU
BU: ERBU
File 3a4: 3a4 (2).csv
File supply: supply (3).xlsx
Finish time: 2020-11-02 14:27:13[2020-11-02 14:32:47]

User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36
Start time: 14:32:47
PCBA_SITE: FOL
BU: ERBU/SRGBU
File 3a4: 3a4 (2).csv
File supply: supply (4).xlsx
Finish time: 14:33:34[2020-11-02 14:35:46]

User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36
Start time: 14:35:46
PCBA_SITE: FOL
BU: ERBU/SRGBU
File 3a4: 3a4 (2).csv
File supply: supply (4).xlsx
Finish time: 14:36:34
[2020-11-02 14:37:57]
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36
Start time: 14:37:57
PCBA_SITE: FOL
BU: ERBU/SRGBU
File 3a4: 3a4 (2).csv
File supply: supply (4).xlsx
Finish time: 14:38:44

[2020-11-02]
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36
Start time: 14:40:18
PCBA_SITE: FOL
BU: ERBU/SRGBU
File 3a4: 3a4 (2).csv
File supply: supply (4).xlsx
Finish time: 14:41:07

[2020-11-02] - making allocation
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36
Start time: 14:46:49
PCBA_SITE: FOL
BU: ERBU
File 3a4: 3a4 (2).csv(size: 89270876)
File supply: supply (3).xlsx(size: 1536987)
Finish time: 14:47:25

[2020-11-02] - making allocation
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36
Start time: 14:53:42
PCBA_SITE: FOL
BU: ERBU
File 3a4: 3a4 (2).csv(size: 85.1Mb)
File supply: supply (3).xlsx(size: 1.5Mb)
Finish time: 14:54:20

[2020-11-02] - download file
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36
File name: FOL SCR allocation (all BU) 10-23 22h37m.xlsx

[2020-11-02] - download file
User info: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36
File name: 3a4.csv-delete